<%- include('./layouts/main.ejs') -%>

<div class="dashboard-container">
    <div class="welcome-section">
        <h1 class="welcome-title">Welcome, <%= user.username %>!</h1>
        <p class="welcome-subtitle">Here's an overview of your projects and tasks</p>
    </div>
    
    <!-- Search Bar -->
    <div class="dashboard-search">
        <form action="/search" method="GET" class="search-form">
            <input 
                type="text" 
                name="q" 
                placeholder="Search projects and tasks..."
                class="search-input"
            >
            <button type="submit" class="search-btn">
                <i class="fas fa-search"></i>
            </button>
        </form>
    </div>
    
    <!-- Stats Cards -->
    <div class="stats-grid">
        <!-- Stats Card -->
        <div class="stat-card primary">
            <h3 class="stat-title">Projects</h3>
            <p class="stat-value"><%= projects.length %></p>
            <a href="/projects" class="stat-link">View all →</a>
        </div>
        
        <!-- Quick Actions -->
        <div class="stat-card success">
            <h3 class="stat-title">Quick Actions</h3>
            <div class="quick-actions">
                <a href="/projects/new" class="btn btn-primary">New Project</a>
                <a href="/tasks" class="btn btn-success">View Tasks</a>
            </div>
        </div>
    </div>
    
    <!-- Recent Projects -->
    <div class="content-section">
        <div class="section-header">
            <h2 class="section-title">Recent Projects</h2>
            <a href="/projects" class="section-link">View All</a>
        </div>
        
        <% if (projects.length > 0) { %>
            <div class="items-list">
                <% projects.forEach(project => { %>
                    <div class="item-card">
                        <h3 class="item-title"><%= project.name %></h3>
                        <p class="item-description"><%= project.description || 'No description' %></p>
                        <a href="/projects/<%= project._id %>" class="item-link">View Details →</a>
                    </div>
                <% }) %>
            </div>
        <% } else { %>
            <div class="empty-state">
                <i class="fas fa-project-diagram icon"></i>
                <p>No projects yet. Create your first project!</p>
            </div>
        <% } %>
    </div>
    
    <!-- Recent Tasks -->
    <div class="content-section">
        <div class="section-header">
            <h2 class="section-title">Recent Tasks</h2>
            <a href="/tasks" class="section-link">View All</a>
        </div>
        
        <% if (tasks.length > 0) { %>
            <div class="items-list">
                <% tasks.forEach(task => { %>
                    <div class="item-card with-border">
                        <div class="item-meta">
                            <h3 class="item-title"><%= task.title %></h3>
                            <span class="status-badge"><%= task.status %></span>
                        </div>
                        <p class="item-description">Project: <%= task.project.name %></p>
                        <a href="/tasks/<%= task._id %>" class="item-link">View Task →</a>
                    </div>
                <% }) %>
            </div>
        <% } else { %>
            <div class="empty-state">
                <i class="fas fa-tasks icon"></i>
                <p>No tasks yet. Add tasks to your projects!</p>
            </div>
        <% } %>
    </div>
</div>