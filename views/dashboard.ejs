<%- include('./layouts/main.ejs') -%>

<div class="dashboard-container">
    <div class="dashboard-welcome">
        <h1>Welcome, <%= user.username %>!</h1>
        <p>Here's an overview of your projects and tasks</p>
    </div>
    
    <!-- Search Bar -->
    <div class="dashboard-search">
        <form action="/search" method="GET" class="search-form">
            <input 
                type="text" 
                name="q" 
                placeholder="Search projects and tasks..."
                class="search-input"
            >
            <button type="submit" class="search-btn">
                <i class="fas fa-search"></i>
            </button>
        </form>
    </div>
    
    <!-- Stats Grid -->
    <div class="dashboard-stats">
        <!-- Stats Card -->
        <div class="stat-card">
            <h3>Projects</h3>
            <p><%= projects.length %></p>
            <a href="/projects">View all <i class="fas fa-arrow-right"></i></a>
        </div>
        
        <!-- Quick Actions -->
        <div class="quick-actions-card">
            <h3>Quick Actions</h3>
            <div class="quick-actions">
                <a href="/projects/new" class="btn btn-primary">
                    <i class="fas fa-plus"></i> New Project
                </a>
                <a href="/tasks" class="btn btn-success">
                    <i class="fas fa-tasks"></i> View Tasks
                </a>
            </div>
        </div>
    </div>
    
    <!-- Recent Projects -->
    <div class="recent-section">
        <div class="recent-header">
            <h2>Recent Projects</h2>
            <a href="/projects">View All <i class="fas fa-arrow-right"></i></a>
        </div>
        
        <% if (projects.length > 0) { %>
            <div class="recent-list">
                <% projects.forEach(project => { %>
                    <div class="recent-item">
                        <h3><%= project.name %></h3>
                        <p><%= project.description || 'No description' %></p>
                        <a href="/projects/<%= project._id %>">
                            View Details <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                <% }) %>
            </div>
        <% } else { %>
            <div class="empty-state">
                <p>No projects yet. Create your first project!</p>
            </div>
        <% } %>
    </div>
    
    <!-- Recent Tasks -->
    <div class="recent-section">
        <div class="recent-header">
            <h2>Recent Tasks</h2>
            <a href="/tasks">View All <i class="fas fa-arrow-right"></i></a>
        </div>
        
        <% if (tasks.length > 0) { %>
            <div class="recent-list">
                <% tasks.forEach(task => { %>
                    <div class="recent-item task-card">
                        <div class="flex justify-between items-center mb-sm">
                            <h3><%= task.title %></h3>
                            <span class="task-status badge badge-success">
                                <%= task.status %>
                            </span>
                        </div>
                        <p class="mb-sm">Project: <%= task.project.name %></p>
                        <a href="/tasks/<%= task._id %>">
                            View Task <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                <% }) %>
            </div>
        <% } else { %>
            <div class="empty-state">
                <p>No tasks yet. Add tasks to your projects!</p>
            </div>
        <% } %>
    </div>
</div>