<%- include('../layouts/main.ejs') -%>

<div class="projects-container">
    <div class="projects-list-header">
        <div class="projects-list-header-content">
            <h1 class="project-title">My Projects</h1>
        </div>
        <div class="projects-list-header-actions">
            <a href="/projects/new" class="btn btn-primary">
                <i class="fas fa-plus"></i> New Project
            </a>
        </div>
    </div>

    <% if (projects.length > 0) { %>
        <div class="projects-grid">
            <% projects.forEach(project => { %>
                <div class="project-card">
                    <div class="project-card-header">
                        <div>
                            <h2 class="project-card-title">
                                <a href="/projects/<%= project._id %>">
                                    <%= project.name %>
                                </a>
                            </h2>
                            <% if (project.description) { %>
                                <p class="project-card-description">
                                    <%= project.description %>
                                </p>
                            <% } %>
                        </div>

                        <div style="text-align: right;">
                            <span class="project-card-badge <%= project.createdBy._id.toString() === user.id ? 'project-card-owner' : '' %>">
                                <%= project.createdBy._id.toString() === user.id ? 'Owner' : 'Member' %>
                            </span>
                        </div>
                    </div>

                    <div class="project-card-footer">
                        <div class="project-card-meta">
                            <i class="fas fa-users"></i>
                            <% 
                            const teamMembersCount = project.members.filter(member =>
                                member._id.toString() !== project.createdBy._id.toString()
                            ).length;
                            %>
                            <%= teamMembersCount %>
                            <%= teamMembersCount === 1 ? "member" : "members" %>
                            â€¢ Created <%= new Date(project.createdAt).toLocaleDateString() %>
                        </div>

                        <div class="project-card-actions">
                            <a href="/projects/<%= project._id %>" class="project-card-action">
                                <i class="fas fa-eye"></i> View
                            </a>
                            <% if (project.createdBy._id.toString() === user.id) { %>
                                <a href="/projects/<%= project._id %>/edit" class="project-card-action project-card-action-edit">
                                    <i class="fas fa-edit"></i> Edit
                                </a>
                            <% } %>
                        </div>
                    </div>
                </div>
            <% }) %>
        </div>
    <% } else { %>
        <div class="projects-empty-state">
            <div class="projects-empty-icon">
                <i class="fas fa-project-diagram"></i>
            </div>
            <h3 class="projects-empty-title">No projects yet</h3>
            <p class="projects-empty-text">Create your first project to start organizing your work</p>
            <a href="/projects/new" class="btn btn-primary">
                <i class="fas fa-plus"></i> Create First Project
            </a>
        </div>
    <% } %>
</div>